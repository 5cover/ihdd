{
  "pact": {
    "visite": {
      "description": "Offre de la catégorie \"visite\".",
      "kind": { "class": {"inherits": "offre"} },
      "references": {
        "langue": {
          "description": "Langues de la visite, pour les visites guidées. Pas de langues = visite non guidée",
          "name"       : "langues"
        }
      },
      "attrs": {
        "id"              : { "type": "integer" , "is": ["pk"      ]                                      },
        "indication_duree": { "type": "interval", "is": ["required"], "description": "Durée de la visite" }
      }
    },
    "langue": {
      "description": "Nom de langue conforme à la norme ISO 639-1.",
      "kind": {"class": {}},
      "references": { "visite": {"description": "Langues disponibles pour une visite guidée", "name": "langues"} },
      "attrs": {
        "iso639_1": {
          "description": "Code de langue normé",
          "type": "character[]",
          "domain": "Code de langue ISO 639-1",
          "is": ["pk"],
          "constraints": ["Longueur = 2"]
        },
        "libelle": { "description": "Nom français de la langue", "type": "character[]", "is": ["required"] }
      }
    },
    "spectacle": {
      "description": "Offre de la catégorie \"spectacle\".",
      "kind": { "class": {"inherits": "offre"} },
      "attrs": {
        "id": { "type": "integer", "is": ["pk"] },
        "indication_duree": { "type": "interval", "is": ["required"], "description": "Durée du spectacle" },
        "capacite_accueil": {
          "type": "integer",
          "is": ["required"],
          "domain": {"min": "0"},
          "description": "Capacité d'accueil du spectacle"
        }
      }
    },
    "activité": {
      "description": "Offre de la catégorie \"activité\".",
      "kind": { "class": {"inherits": "offre"} },
      "attrs": {
        "id": { "type": "integer", "is": ["pk"] },
        "indication_duree": { "type": "interval", "is": ["required"], "description": "Durée de l'activité" },
        "age_requis": { "type": "integer", "description": "Âge minimum requis", "domain": {"min": "0"} },
        "prestations_incluses": { "type": "character[]", "is": ["required"], "description": "Prestations incluses" },
        "prestations_non_incluses": {"type": "character[]", "description": "Prestations non incluses"}
      }
    },
    "restaurant": {
      "description": "Offre de la catégorie \"restaurant\".",
      "kind": { "class": {"inherits": "offre"} },
      "attrs": {
        "id": { "type": "integer", "is": ["pk"] },
        "richesse": {
          "type": "integer",
          "is": ["required"],
          "description": "Niveau de richesse (prestige) du restaurant",
          "domain": {"min_incl": true, "min": "1", "max": "3", "max_incl": true},
          "remarks": "1: €, 2: €€, 3: €€€"
        },
        "sert_petit_dejeuner": {
          "type": "boolean",
          "description": "Si ce restaurant sert le petit-déjeuner",
          "is": [ {"default": "false"}, "required" ]
        },
        "sert_brunch": {
          "type": "boolean",
          "description": "Si ce restaurant sert un brunch",
          "is": [ {"default": "false"}, "required" ]
        },
        "sert_dejeuner": {
          "type": "boolean",
          "description": "Si ce restaurant sert le déjeuner",
          "is": [ {"default": "false"}, "required" ]
        },
        "sert_diner": {
          "type": "boolean",
          "description": "Si ce restaurant sert le dîner",
          "is": [ {"default": "false"}, "required" ]
        },
        "sert_boissons": {
          "type": "boolean",
          "description": "Si ce restaurant sert des boissons",
          "is": [ {"default": "false"}, "required" ]
        },
        "carte": { "type": "character[]", "description": "Carte du restaurant", "is": ["required"] }
      }
    },
    "moyen_de_paiement": {
      "description": "Moyen de paiement associés à un compte professionnel pour la facturation automatique des offres payantes.\n\nImplémentations futures :\n- Paypal\n- Autorisation de prélèvement\n- ...\n\nPermet le prélèvement automatique (au 1er du mois)",
      "kind": { "class": {"abstract": true} },
      "references": {
        "prive": {
          "description": "Professionnel privé auquel ce moyen de paiement appartient",
          "name"       : "moyens de paiement"                                        ,
          "qualifier"  : "siren"
        }
      },
      "attrs": {
        "id": { "type": "serial", "is": ["pk"] }
      }
    },
    "public": {
      "kind": { "class": {"inherits": "professionnel"} },
      "description": "Compte professionnel public",
      "attrs": {
        "id": { "type": "integer", "is": ["pk"] }
      }
    },
    "privé": {
      "description": "Compte professionnel privé",
      "kind": { "class": {"inherits": "professionnel"} },
      "attrs": {
        "id": { "type": "integer", "is": ["pk"] },
        "siren": {
          "type": "character[]",
          "domain": "Numéro SIREN",
          "description": "Numéro SIREN du professionnel",
          "is": ["unique"]
        }
      }
    },
    "option": {
      "description": "Une option de mise en avant pour une offre premium. Entraîne une coût supplémentaire.\n\nEnsemble fermé de valeurs :\n\n- Relief\n- À La Une",
      "kind": {"class": {}},
      "attrs": {
        "nom"              : { "is": ["pk"], "type": "character[]", "description": "Nom de l'option" }                ,
        "prix_hebdomadaire": { "is": ["required"], "type": "decimal", "description": "Prix hebdomadaire de l'option" }
      }
    },
    "departement": {
        "description": "Un département français",
        "kind": {"class": {}},
        "attrs": {
            "numero": {
                "is": ["pk"],
                "description": "Numéro de département",
                "type": "character[]",
                "domain": "Numéros de département"
            },
            "nom": {
                "is": ["required", "unique"],
                "type": "character[]",
                "description": "Nom du département"
            }
        }
    },
    "commune": {
        "description": "Une commune française",
        "kind": {"class": {}},
        "attrs": {
            "code": {
                "type": "integer",
                "is": ["pk"],
                "description": "Code INSEE de la commune"
            },
            "numero_departement": {
                "type": "character[]",
                "is": ["required"],
                "domain": "Numéros de département",
                "description": "Numéro de département de la commune"
            },
            "nom": {
                "is": ["required"],
                "type": "character[]",
                "description": "Nom de la commune"
            }
        },
        "references": {
            "departement": {
                "description": "Département de la commune",
                "name": "departement"
            }
        }
    },
    "adresse": {
        "kind": {"class": {}},
        "attrs": {
          "id": { "type": "serial", "is": ["pk"] },
          "numero_voie": {
            "type": "integer",
            "description": "Numéro dans la voie",
            "domain": {"min_incl": true, "min": "0"},
            "constraints": ["Existe si complement_numero existe"],
            "is": ["required"]
          },
          "complement_numero": {
            "type": "character[]",
            "description": "Complément au numéro dans la voie (B, T, Q, C)",
            "constraints": ["N'existe pas si numero n'existe pas", "Longueur ≤ 10"]
          },
          "nom_voie": {"type": "character[]", "description": "Nom de la voie"},
          "localite": {"type": "character[]", "description": "Hameau, lieu-dit... Chaîne vide pour aucun."},
          "code_postal": { "type": "character[]", "description": "Code postal", "constraints": ["Longueur = 5"] },
          "precision_int": {"type": "character[]", "description": "Précision interne (apt., Boîte à lettre, étage...)"},
          "precision_ext": {"type": "character[]", "description": "Précision externe (bâtiment, voie, résidence...)"},
          "lat": {
            "type": "decimal",
            "description": "Latitude",
            "domain": "Latitude décimale",
            "constraints": ["Existe avec long"]
          },
          "long": {
            "type": "decimal",
            "description": "Longitude",
            "domain": "Longitude décimale",
            "constraints": ["Existe avec lat"]
          }
        },
        "references": {
          "commune": {"description": "Commune où se trouve l'adresse"},
          "offre"  : {"description": "Offre située à cette adresse"  },
          "compte" : {"description": "Compte situé à cette adresse"  }
        },
        "description": "Adresse postale normalisée (AFNOR NF Z 10-011)."
      },
      "abonnement": {
        "description": "Modèle d'abonnement pour professionnel",
        "kind": {"class": {}},
        "attrs": {
          "libelle"        : { "type": "character[]", "description": "Libellé de l'abonnement", "is": ["pk"] }          ,
          "prix_journalier": { "type": "decimal", "description": "Prix journalier de l'abonnement", "is": ["required"] },
          "description"    : { "type": "character[]", "description": "description de l'abonnement", "is": ["required"] }
        }
      },
      "image": {
        "description": "Une image téléversée par un utilisateur",
        "kind": {"class": {}},
        "attrs": {
            "id": {
                "type": "serial",
                "is": ["pk"]
            },
            "taille": {
                "type": "integer",
                "is": ["required"],
                "description": "Taille en octets de l'image"
            },
            "mime_subtype": {
                "type": "character[]",
                "is": ["required"],
                "description": "Sous-type MIME image/*"
            },
            "legende": {
                "type": "character[]",
                "description": "Légende"
            }
        }
      },
      "signalable": {
        "kind": {"class": {"abstract": true}},
        "description": "Un contenu pouvant être signalé",
        "attrs": {
            "id": {
                "type": "serial",
                "is": ["pk"]
            }
        }
      }
  },
  "tchattator": {
    "test": {
      "kind": {"class": {}},
      "attrs": {
        "a": { "type": "time", "is": ["pk"] },
        "b": { "type": "time", "is": ["required"] },
        "c": { "type": "time", "is": ["required", "unique"] },
        "d": {
          "type": "time",
          "is": [ "required", "unique", {"default": "value"} ]
        },
        "e": {
          "type": "time",
          "is": [ "required", {"default": "value"} ]
        },
        "f": {
          "type": "time",
          "is": [ "required", {"computed": "by"} ]
        },
        "g": {
          "type": "time",
          "is": [ "unique", {"default": "value"} ]
        },
        "h": {
          "type": "time",
          "is": [ {"computed": "by"} ]
        },
        "i": {
          "type": "time",
          "is": [ {"default": "value"} ]
        }
      }
    }
  }
}
